<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>components/TextEditor/BulletList.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Collection.html">Collection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Collection.html#closeCollection">closeCollection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Collection.html#getSavedBullets">getSavedBullets</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Collection.html#openCollection">openCollection</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DailyHabit.html">DailyHabit</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DailyLogBullet.html">DailyLogBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DailyLogBullet.html#initialiseBullet">initialiseBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DailyLogBullet.html#keyDownListener">keyDownListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DailyLogBullet.html#serialize">serialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="EventWrapper.html">EventWrapper</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventWrapper.html#getBulletTree">getBulletTree</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventWrapper.html#getStorageKey">getStorageKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventWrapper.html#initialise">initialise</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="EventWrapper.html#render">render</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="JournalIcon.html">JournalIcon</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module.html#.exports">exports</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Navbar.html">Navbar</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SimpleBullet.html">SimpleBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SimpleBullet.html#initialiseBullet">initialiseBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SimpleBullet.html#serialize">serialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="TaskBullet.html">TaskBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TaskBullet.html#initialiseBullet">initialiseBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TaskBullet.html#keyDownListener">keyDownListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TaskBullet.html#serialize">serialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Tracker.html">Tracker</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addCalendarDays">addCalendarDays</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#addClose">addClose</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addCollection">addCollection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addCurrentDate">addCurrentDate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addFillerCircles">addFillerCircles</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#addForm">addForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addHabit">addHabit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#baseKeydownListener">baseKeydownListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#baseKeyupListener">baseKeyupListener</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#bulletModifiers">bulletModifiers</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#bulletTypes">bulletTypes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#clearContainerNode">clearContainerNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#closeAddForm">closeAddForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#closeForm">closeForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createBullet">createBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#DATE">DATE</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#deleteBullet">deleteBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#deleteCollection">deleteCollection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#deleteHabit">deleteHabit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#editColor">editColor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#exitSingleNesting">exitSingleNesting</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#flyoutMenu">flyoutMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#focus">focus</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getDailyLogUID">getDailyLogUID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getFirstDay">getFirstDay</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getFormattedDate">getFormattedDate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getHabits">getHabits</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getMonthDays">getMonthDays</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getMonthDaysLeap">getMonthDaysLeap</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getMonthlyLogUID">getMonthlyLogUID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getMonthName">getMonthName</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getSavedBullets">getSavedBullets</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getTheme">getTheme</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getTitle">getTitle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hideMenu">hideMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#initialiseBullet">initialiseBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#menuButton">menuButton</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#navSpan">navSpan</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#nestBulletInside">nestBulletInside</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#nestCurrBullet">nestCurrBullet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#openEditForm">openEditForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#openForm">openForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateEventWrappers">populateEventWrappers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeHabit">removeHabit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#saveEvents">saveEvents</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#saveInputs">saveInputs</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#saveTasks">saveTasks</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#serialize">serialize</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setTaskEditor">setTaskEditor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showMenu">showMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showSave">showSave</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#submitAdd">submitAdd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#toggleHabit">toggleHabit</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#TOP_LEVEL_ORDER_ID">TOP_LEVEL_ORDER_ID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#transferFocusTo">transferFocusTo</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">components/TextEditor/BulletList.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * This is a wrapper element which will take a list of bullet values and render
 * it in a bullet list format and also return the updated list of bullets
 * (with nested) as they are edited
 */
const TOP_LEVEL_ORDER_ID = 0;
const autoSaveInterval = 1000; // in ms
class BulletList extends HTMLElement {
  constructor() {
    super();
    this.elementName = '';
    this.storageIndex = {};
    this.bulletConfigs = {};
    this.state = {
      value: [],
      nestLimit: 2,
      nextID: 1,
      unsaved: false,
    };

    this.listData = {
      bulletElements: {},
      tree: {},
      parents: {},
      topLevelOrder: [],
    };

    // Callbacks for Bullet Editing
    this.nextIDCallback = () => {
      this.state.nextID += 1;
      return this.state.nextID - 1;
    };

    /**
     * Gets the closest available bullet, whether up or down.
     *
     * @param {number} bulletID The id of the bullet to check neighbors for.
     * @param {boolean} directionUp Whether to look for the top of bullet `bulletID`.
     * @returns The HTMLElement of the bullet to switch to.
     */
    this.getAdjacentBullet = (bulletID, directionUp) => {
      const parentID = this.listData.parents[bulletID];
      let sibblingBullets; let
        nextBulletID;
      if (parentID === null) sibblingBullets = this.listData.tree[TOP_LEVEL_ORDER_ID];
      else sibblingBullets = this.listData.tree[parentID][this.storageIndex.children];

      const currBulletIndex = sibblingBullets.indexOf(bulletID);

      if (directionUp) {
        if (currBulletIndex === 0) nextBulletID = this.listData.parents[bulletID];
        else nextBulletID = this.findLastBulletInside(sibblingBullets[currBulletIndex - 1]);
      } else {
        nextBulletID = this.findNextBulletDown(bulletID);
      }
      if (nextBulletID === null) return null;
      return this.listData.bulletElements[nextBulletID];
    };

    /**
     * Object with callback functions to update BulletList keeping in sync with DOM
     * Data structures to be updated: listData.bulletElements, listData.parents, listData.tree
     */
    this.updateCallbacks = {
      saveData: () => console.error('Bullet.saveDataCallback is not setup'), // This callback needs to be provided by the user through `setSaveData()`
      /**
       * Add the new bullet to BulletList's data structures for bullets
       *
       * @param {number} sourceID The original bullet where we're creating another bullet from.
       * @param {HTMLElement} newBullet the contents of the next bullet.
       */
      createBullet: (sourceID, newBullet) => {
        // Assumption: A bullet can be created only in the same nest level as the `sourceID`
        // Save in tree
        this.state.unsaved = true;
        this.listData.tree[newBullet.uniqueID] = newBullet.serialize(); // Children is left as empty

        const parentID = this.listData.parents[sourceID];

        let sibblingsOrder = [];
        if (parentID === null) sibblingsOrder = this.listData.tree[TOP_LEVEL_ORDER_ID];
        else sibblingsOrder = this.listData.tree[parentID][this.storageIndex.children];

        const sourceIndex = sibblingsOrder.indexOf(sourceID);
        sibblingsOrder.splice(sourceIndex + 1, 0, newBullet.uniqueID); // Save in tree (structure)
        this.state.unsaved = true;

        const saving = document.querySelector('.saving');
        if (saving) { saving.innerHTML = 'Saving...'; }

        this.listData.bulletElements[newBullet.uniqueID] = newBullet; // Save in bulletElements
        this.listData.parents[newBullet.uniqueID] = parentID; // Save in parents
      },
      /**
       *
       * Decides whether a bullet can be deleted based on the following condition:
       *    If this is the only top level bullet, this bullet cannot be deleted
       *    Else bullet can be deleted
       *
       * Deletes the bullet from the data structures if bullet can be deleted
       *
       * @param {number} bulletID The ID of the bullet
       * @returns Whether the bullet can be deleted or not.
       */
      deleteBullet: (bulletID) => {
        if (
          this.listData.tree[TOP_LEVEL_ORDER_ID].includes(bulletID)
          &amp;&amp; (this.listData.tree[TOP_LEVEL_ORDER_ID].length &lt;= 1)
        ) {
          return false; // Only bullet remaining so deletion not allowed
        }
        this.state.unsaved = true;
        delete this.listData.tree[bulletID];

        const parentID = this.listData.parents[bulletID];
        let sibblingsOrder = [];
        if (parentID === null) sibblingsOrder = this.listData.tree[TOP_LEVEL_ORDER_ID];
        else sibblingsOrder = this.listData.tree[parentID][this.storageIndex.children];
        const bulletIndex = sibblingsOrder.indexOf(bulletID);
        if (bulletIndex !== -1) {
          this.state.unsaved = true;
          sibblingsOrder.splice(bulletIndex, 1);
        }

        delete this.listData.bulletElements[bulletID];
        delete this.listData.parents[bulletID];

        return true;
      },
      /**
       * Modifies a bullet's content in the data structures.
       *
       * @param {string} parameter Parameter to modify.
       * @param {number} bulletID ID of bullet to modify.
       * @param {string|boolean|array} newValue new value of parameter for Bullet.
       */
      editContent: (parameter, bulletID, newValue) => {
        this.state.unsaved = true;
        this.listData.tree[bulletID][this.storageIndex[parameter]] = newValue;
        const saving = document.querySelector('.saving');
        if (saving) { saving.innerHTML = 'Saving...'; }
      },
      /**
       * Updates the data structure to nest the current bullet into another bullet.
       *
       * @param {number} bulletID Bullet to nest into parent.
       * @param {number} newParentID ID of parent bullet to nest into.
       * @param {boolean} forward
       *    -> Whether the bullet is being nested inside another or outside of one bullet
       */
      nestCurrBullet: (bulletID, newParentID, forward) => {
        this.state.unsaved = true;
        const oldParentID = this.listData.parents[bulletID];
        const saving = document.querySelector('.saving');
        if (saving) { saving.innerHTML = 'Saving...'; }
        // Remove from parent
        let sibblingsOrder;
        if (oldParentID === null) sibblingsOrder = this.listData.tree[TOP_LEVEL_ORDER_ID];
        else sibblingsOrder = this.listData.tree[oldParentID][this.storageIndex.children];
        const index = sibblingsOrder.indexOf(bulletID);
        if (index !== -1) sibblingsOrder.splice(index, 1);

        // Add to new parent
        if (forward) {
          this.listData.tree[newParentID][this.storageIndex.children].push(bulletID);
        } else {
          let newSibblingsOrder;
          if (newParentID === null) newSibblingsOrder = this.listData.tree[TOP_LEVEL_ORDER_ID];
          else newSibblingsOrder = this.listData.tree[newParentID][this.storageIndex.children];
          const oldParentIndex = newSibblingsOrder.indexOf(oldParentID);
          newSibblingsOrder.splice(oldParentIndex + 1, 0, bulletID);
        }

        // Update ID - parent map
        this.listData.parents[bulletID] = newParentID;
      },
    };
  }

  /**
   * User must initialise the following attributes for the bullet list to function properly
   *
   * @param {Object} listAttributes
   * @param {function} listAttributes.saveDataCallback
   * @param {number} listAttributes.nestLimit - Limit for nesting levels
   * @param {Object} listAttributes.bulletTree - Adjacency list structure with content for the list
   * @param {Object} listAttributes.storageIndex - Gives storage indices of each bullet parameter
   * @param {Object} listAttributes.elementName
   * @param {Object} [listAttributes.bulletStyle] - CSS Styling for Bullet
   */
  initialiseList(listAttributes) {
    this.updateCallbacks.saveData = () => {
      if (this.state.unsaved) {
        listAttributes.saveDataCallback(this.listData.tree);
        this.state.unsaved = false;
        const saving = document.querySelector('.saving');
        if (saving) { saving.innerHTML = '&amp;nbsp;'; }
      }
    };
    this.state.nestLimit = listAttributes.nestLimit;
    this.storageIndex = listAttributes.storageIndex;
    this.elementName = listAttributes.elementName;
    if ('bulletConfigs' in listAttributes) this.bulletConfigs = listAttributes.bulletConfigs; // Configs to pass to new Bullet

    this.innerHTML = '&lt;div class="bullet-list">&lt;/div>';
    this.setValue(listAttributes.bulletTree);

    window.onbeforeunload = () => {
      this.updateCallbacks.saveData();
    };
  }

  /**
   * Sets auto-save timer for bullet list.
   */
  connectedCallback() {
    this.autoSaveHandler = setInterval(() => {
      this.updateCallbacks.saveData();
    }, autoSaveInterval);
  }

  /**
   * Removes auto-save timer for bullet list.
   */
  disconnectedCallback() {
    clearInterval(this.autoSaveHandler);
  }

  /**
   * Gets the tree of bullets in this list.
   * @returns The tree of bullets in this list.
   */
  getBulletTree() {
    return this.listData.tree;
  }

  /**
   * Added for testing. Gets all of the bullets in the current list,
   * mapped via ID to their HTMLElement.
   *
   * @returns Map with key `bulletID` and value HTMLElement.
   */
  getBulletElements() {
    return this.listData.bulletElements;
  }

  /**
   * Sets the nextID. User should not be setting this unless overriding the automatic
   * method is causing troubles. By default, nextID is set by parsing the existing IDs
   * when setValue is called.
   * @param {*} nextID
   */
  setNextID(nextID) {
    this.state.nextID = nextID;
  }

  /**
   * Sets and renders the bullet list according to the passed bullet tree
   * @param {Object} bulletsTree - Tree in format similar to adjacency list.
   * Example of bulletsTree would be: {
   *  0 : [1, 4, 6],
   *  1: ['Bullet 2', [2, 7, 3]],
   *  2: ['Sub Bullet 1', []],
   *  3: ['Sub Bullet 2', []],
   *  4: ['Sub Bullet 3', [5]],
   *  5: ['Sub Bullet 4', []],
   *  6: ['Bullet 5', []],
   *  7: ['Sample', []]
   * }
   */
  setValue(bulletsTree) {
    const container = this.querySelector('.bullet-list');

    this.listData.tree = bulletsTree;
    this.setNextID(Math.max(...Object.keys(bulletsTree)) + 1);
    const toplevelBullets = bulletsTree[0];
    toplevelBullets.forEach((bulletIDStr) => {
      const bulletID = parseInt(bulletIDStr, 10);

      this.listData.parents[bulletID] = null;
      const traversalStack = [bulletID];

      while (traversalStack.length > 0) {
        const currID = traversalStack.pop();
        const currBullet = document.createElement(this.elementName);
        currBullet.initialiseBullet({
          updateCallbacks: this.updateCallbacks,
          getNextID: this.nextIDCallback,
          getAdjacentBullet: this.getAdjacentBullet,
          uniqueID: currID,
          textContent: bulletsTree[currID][this.storageIndex.value],
          storageIndex: this.storageIndex,
          data: this.listData.tree[currID],
          bulletConfigs: this.bulletConfigs,
        });

        if (this.listData.parents[currID] === null) {
          currBullet.setNestDepthRem(this.state.nestLimit);
          container.appendChild(currBullet);
        } else {
          this.listData.bulletElements[this.listData.parents[currID]].nestBulletInside(currBullet);
        }
        this.listData.bulletElements[currID] = currBullet;
        const children = bulletsTree[currID][this.storageIndex.children];

        children.slice().reverse().forEach((childID) => {
          this.listData.parents[childID] = currID;
          traversalStack.push(childID);
        });
      }
    });
  }

  /**
   * Returns the last bullet nested inside `bulletID`
   * @param {*} bulletID
   * @returns {*} bulletID
   */
  findLastBulletInside(bulletID) {
    const numChildrens = this.listData.tree[bulletID][this.storageIndex.children].length;
    if (numChildrens === 0) return bulletID;
    return this.findLastBulletInside(
      this.listData.tree[bulletID][this.storageIndex.children][numChildrens - 1],
    );
  }

  /**
   * Returns the next bullet in the downward direction
   * @param {*} bulletID
   * @param {Boolean} allowChildren
   * @returns {*} bulletID
   */
  findNextBulletDown(bulletID, allowChildren = true) {
    if (bulletID === null) return null;
    if (allowChildren) {
      const children = this.listData.tree[bulletID][this.storageIndex.children];
      if (children.length > 0) return children[0]; // Return its first children
    }

    const parentID = this.listData.parents[bulletID];
    let sibblingBullets;

    if (parentID === null) sibblingBullets = this.listData.tree[TOP_LEVEL_ORDER_ID];
    else sibblingBullets = this.listData.tree[parentID][this.storageIndex.children];
    const currBulletIndex = sibblingBullets.indexOf(bulletID);

    if (currBulletIndex &lt; sibblingBullets.length - 1) {
      return sibblingBullets[currBulletIndex + 1];
    } // Return next bullet in current nested level

    return this.findNextBulletDown(parentID, false);
  }
}

customElements.define('bullet-list', BulletList);
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Fri Jun 11 2021 04:03:21 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
